<!DOCTYPE html>
<html>
<head>
    <title>Quick Check</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .info { 
            background: #e3f2fd; 
            padding: 15px; 
            margin: 10px 0;
            border-radius: 5px;
        }
        .error { 
            background: #ffebee; 
            padding: 15px; 
            margin: 10px 0;
            border-radius: 5px;
        }
        .success { 
            background: #e8f5e9; 
            padding: 15px; 
            margin: 10px 0;
            border-radius: 5px;
        }
        pre { 
            background: #f5f5f5; 
            padding: 10px; 
            overflow-x: auto;
            border-radius: 5px;
        }
        button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #1976D2;
        }
        button.danger {
            background: #f44336;
        }
        button.danger:hover {
            background: #d32f2f;
        }
    </style>
</head>
<body>
    <h1>üîç Kawaii Quest - Quick Data Check</h1>
    
    <div>
        <button onclick="check()">üîÑ Sprawd≈∫ Dane</button>
        <button onclick="location.href='index.html'">üè† Wr√≥ƒá do Aplikacji</button>
        <button class="danger" onclick="clearAndReset()">üóëÔ∏è Wyczy≈õƒá i Resetuj</button>
    </div>
    
    <div id="results"></div>
    
    <script>
        function check() {
            const results = document.getElementById('results');
            results.innerHTML = '';
            
            try {
                const data = localStorage.getItem('kawaiiQuestData');
                
                if (!data) {
                    results.innerHTML = '<div class="error"><h2>‚ùå Brak danych</h2><p>localStorage jest pusty. Aplikacja nie ma ≈ºadnych zapisanych danych.</p></div>';
                    return;
                }
                
                const parsed = JSON.parse(data);
                
                // Today's date
                const today = new Date();
                const todayKey = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
                
                let html = '<div class="success"><h2>‚úÖ Dane znalezione!</h2></div>';
                
                // Challenge info
                html += '<div class="info">';
                html += '<h3>üìä Wyzwanie:</h3>';
                html += `<p><strong>Dzisiejsza data:</strong> ${todayKey}</p>`;
                html += `<p><strong>Dzie≈Ñ wyzwania:</strong> ${parsed.challenge?.currentDay || 0}/${parsed.challenge?.totalDays || 75}</p>`;
                html += `<p><strong>Uko≈Ñczone dni:</strong> ${parsed.challenge?.completedDays?.length || 0}</p>`;
                html += `<p><strong>Streak:</strong> ${parsed.streak || 0}</p>`;
                html += '</div>';
                
                // Completed days list
                if (parsed.challenge?.completedDays && parsed.challenge.completedDays.length > 0) {
                    html += '<div class="info">';
                    html += '<h3>üìÖ Uko≈Ñczone dni:</h3>';
                    html += '<pre>' + JSON.stringify(parsed.challenge.completedDays, null, 2) + '</pre>';
                    
                    // Check if today is completed
                    const todayCompleted = parsed.challenge.completedDays.includes(todayKey);
                    html += todayCompleted 
                        ? '<p>‚úÖ <strong>Dzisiaj jest uko≈Ñczony</strong></p>' 
                        : '<p>‚ö†Ô∏è <strong>Dzisiaj NIE jest uko≈Ñczony</strong></p>';
                    
                    // Latest completed day
                    const sorted = [...parsed.challenge.completedDays].sort().reverse();
                    html += `<p><strong>Ostatni uko≈Ñczony dzie≈Ñ:</strong> ${sorted[0]}</p>`;
                    
                    const latestDate = new Date(sorted[0] + 'T12:00:00');
                    const todayDate = new Date(todayKey + 'T12:00:00');
                    const diff = Math.floor((todayDate - latestDate) / (1000 * 60 * 60 * 24));
                    html += `<p><strong>Dni od ostatniego uko≈Ñczonego:</strong> ${diff}</p>`;
                    
                    if (diff > 1) {
                        html += '<p>‚ö†Ô∏è <strong>Streak jest zerwany!</strong> (ostatni dzie≈Ñ by≈Ç wiƒôcej ni≈º 1 dzie≈Ñ temu)</p>';
                    } else if (diff === 1) {
                        html += '<p>‚úÖ <strong>Streak kontynuowany</strong> (wczoraj by≈Ç uko≈Ñczony)</p>';
                    } else {
                        html += '<p>‚úÖ <strong>Dzisiaj jest uko≈Ñczony</strong></p>';
                    }
                    
                    html += '</div>';
                }
                
                // Steps data
                if (parsed.steps && Object.keys(parsed.steps).length > 0) {
                    const totalSteps = Object.values(parsed.steps).reduce((sum, s) => sum + s, 0);
                    html += '<div class="info">';
                    html += '<h3>üë£ Kroki:</h3>';
                    html += `<p><strong>Ca≈Çkowita suma:</strong> ${totalSteps.toLocaleString()} / ${parsed.settings?.stepsGoal?.toLocaleString() || 25000}</p>`;
                    html += '<details><summary>Zobacz szczeg√≥≈Çy</summary><pre>' + JSON.stringify(parsed.steps, null, 2) + '</pre></details>';
                    html += '</div>';
                }
                
                // Study hours
                if (parsed.studyHours && Object.keys(parsed.studyHours).length > 0) {
                    const totalHours = Object.values(parsed.studyHours).reduce((sum, h) => sum + h, 0);
                    html += '<div class="info">';
                    html += '<h3>üìö Nauka:</h3>';
                    html += `<p><strong>Ca≈Çkowita suma:</strong> ${totalHours.toFixed(1)} / ${parsed.settings?.studyGoal || 100}h</p>`;
                    html += '<details><summary>Zobacz szczeg√≥≈Çy</summary><pre>' + JSON.stringify(parsed.studyHours, null, 2) + '</pre></details>';
                    html += '</div>';
                }
                
                // Full data dump
                html += '<div class="info">';
                html += '<h3>üóÇÔ∏è Pe≈Çne dane:</h3>';
                html += '<details><summary>Zobacz wszystkie dane</summary><pre>' + JSON.stringify(parsed, null, 2) + '</pre></details>';
                html += '</div>';
                
                results.innerHTML = html;
                
            } catch (e) {
                results.innerHTML = `<div class="error"><h2>‚ùå B≈ÇƒÖd</h2><p>${e.message}</p></div>`;
            }
        }
        
        function clearAndReset() {
            if (confirm('Czy na pewno chcesz wyczy≈õciƒá WSZYSTKIE dane? Tego nie mo≈ºna cofnƒÖƒá!')) {
                localStorage.removeItem('kawaiiQuestData');
                document.getElementById('results').innerHTML = '<div class="success"><h2>‚úÖ Dane wyczyszczone!</h2><p>Od≈õwie≈º aplikacjƒô aby rozpoczƒÖƒá od nowa.</p></div>';
            }
        }
        
        // Auto-check on load
        window.onload = check;
    </script>
</body>
</html>
